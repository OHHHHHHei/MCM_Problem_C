# 问题二建模方案：基于后验粒子群的概率性反事实分析 (Probabilistic Static Counterfactual Analysis, PSCA)

## 1. 核心理念与建模原则

在第一题中，我们通过 SMC 粒子滤波得到了一组能够描述粉丝投票隐变量 $\pi_{i,t}$ 的**后验粒子群**。

在第二题中，我们的核心任务是**"平行宇宙推演"**。为了克服数据右截断（Right-Censoring）问题并充分利用模型的不确定性信息，我们确立以下建模原则：

1. **逐周静态切片 (Week-wise Static Snapshot)**：
    
    我们不进行全赛季的动态重演（避免虚构已淘汰选手的后续分数），而是将每一周视为一个独立的"实验场"。我们使用该周**真实在场**的选手集合和**真实**的评审分，仅改变"聚合规则"，观察淘汰结果的异质性。
    
2. **全粒子概率推断 (Full-Particle Probabilistic Inference)**：
    
    我们不使用单一的后验均值 $\mathbb{E}[\pi]$ 进行确定性模拟，而是利用所有有效粒子 $\{\pi_{i,t}^{(k)}, w_t^{(k)}\}_{k=1}^K$ 进行加权蒙特卡洛模拟。结论将以**概率**形式呈现。

3. **自适应淘汰名额 (Adaptive Elimination Count)**：
    
    在反事实模拟中，第 $t$ 周的模拟淘汰人数 $M_t$ 必须与该周**真实发生的淘汰人数**保持一致。
    $$E^{(k)} = \text{argmin}_{M_t} (S^{(k)})$$
    即：若现实中 Week 7 淘汰了 2 人，则模型选取生存分最低的 2 人作为模拟淘汰者。这确保了 Agreement Rate 和 Flip Rate 的计算维度一致。

**关键假设 (Assumption of Weekly Independence)**：
> Except for explicit multi-night events (e.g., Finals, double elimination weeks), scores are reset weekly. For combined weeks, we aggregate inputs before the snapshot analysis.

---

## 2. 规则的数学形式化

设在第 $t$ 周，存活选手集合为 $\mathcal{C}_t$，某选手 $i \in \mathcal{C}_t$ 的评审得分为 $J_{i,t}$，第 $k$ 个粒子对应的粉丝投票份额为 $\pi_{i,t}^{(k)}$。

### 2.1 排名规则 (Rank Rule, $R_{rank}$)

此规则用于 S1-S2 及 S28+。生存分 $S$ 定义为负的排名之和（排名越小越好，分值越大越好）：

$$S_{i,t} = -(\text{Rank}(J) + \text{Rank}(\pi))$$

**平局决胜规则 (Tie-Breaking Condition)**:
$$\text{If } S_{i,t}^{(k)} = S_{j,t}^{(k)}, \text{ prefer } i \text{ over } j \iff \pi_{i,t}^{(k)} > \pi_{j,t}^{(k)}$$

注：$\text{Rank}(\cdot)$ 为降序排名，第1名 rank 为 1。仅在总分平局时，投票份额较高者胜出。

### 2.2 百分比规则 (Percentage Rule, $R_{pct}$)

此规则用于 S3-S27。生存分 $S$ 定义为归一化份额之和：

$$S_{i,t}^{(k)}|_{Pct} = \underbrace{\frac{J_{i,t}}{\sum_{j \in \mathcal{C}_t} J_{j,t}}}_{\text{Judge Share}} + \underbrace{\pi_{i,t}^{(k)}}_{\text{Fan Share}}$$

### 2.3 评审拯救规则: 包装器设计 (Judge Save Rule, $R_{save}$)

此规则用于 S28+。**关键设计原则**：Judge Save 是一个**包装器函数** (Wrapper Function)：

```
SaveWrapper(base_metric):
    1. S = base_metric(J, π)         ← 使用传入的基准规则计算生存分
    2. Bottom2 = argmin_2(S)         ← 从该生存分中取最低两人
    3. P(Save) = σ(β·ΔJ)             ← 评审根据技术分决定拯救
```

> **为什么必须这样设计？** 如果 Bottom 2 总是用 Rank 规则计算，那么 "Pct + Save" 就不是纯粹的控制变量实验。包装器设计确保 2×2 矩阵的每个象限都是真正的 **"控制变量实验"**。

这是一个**两阶段随机过程**：

- **阶段一：确定 Bottom 2 (基于 base_metric)**
    
    $$\mathcal{B}_t^{(k)} = \{u, v\} = \text{argmin}_2\left( S_{base}^{(k)} \right)$$
    
- **阶段二：概率性拯救 (基于技术分)**
    
    $$P(\text{Save } u | \mathcal{B}_t^{(k)}) = \sigma\left( \beta_{judge} \cdot (J_{u,t} - J_{v,t}) \right)$$
    
    其中 $\sigma(z) = \frac{1}{1+e^{-z}}$，$\beta_{judge}=2.0$（Q1 估计值）。

---

## 3. 宏观分析：规则差异性度量

为了回答"哪种规则更偏向粉丝"，我们对所有赛季 $t=1 \dots T$ 进行遍历。

### 3.1 规则一致性分析 (Rule Agreement Analysis)

**首先回答最基本的问题：两种规则的结果有多大差异？**

**统计量**：
- **一致率 (Agreement Rate)**：在 34 个赛季共 $N$ 次淘汰事件中，Rank 和 Percentage 规则在多少比例的情况下输出了相同的淘汰者。
- **差异分类**：在剩下的差异案例中，分别统计：
  - Rank 规则救回了高人气选手的次数
  - Percentage 规则救回了高人气选手的次数

**可视化**：使用饼图或堆叠柱状图直观展示 Agreement vs. Disagreement。

### 3.2 翻盘概率 (Probability of Flip)

**规则差异性度量 (Measuring Rule Discrepancy)**

我们从两个维度衡量规则的影响：

1. **反事实翻盘率 (Counterfactual Flip Rate)**:
    
    $$P(E_{new} \neq E_{real})$$
    
    衡量新规则对**历史既定事实**的改变能力，用于评估"改规则是否会改写历史"。
    
2. **规则内秉背离度 (Intrinsic Rule Divergence)**:
    
    $$P(E_{RuleA} \neq E_{RuleB}) = \sum_{k=1}^N w_t^{(k)} \cdot \mathbb{I}\left( \text{Sim}(R_A, \pi^{(k)}) \neq \text{Sim}(R_B, \pi^{(k)}) \right)$$
    
    衡量两种规则在**相同输入下**产生不同输出的概率。这一指标剔除了一切外部干扰（如历史噪声、模型偏差），纯粹反映规则本身的**机制距离**。

### 3.3 粉丝一致性得分 (Fan Alignment Score)

为了量化规则属性，我们计算被淘汰者在不同维度上的排位期望。设 $E^{(k)}$ 为粒子 $k$ 在新规则下模拟出的淘汰者。

**定义：粉丝一致性得分 (Fan Alignment Score)**

$$\text{Alignment}_{Fan}(R) = \frac{\mathbb{E}_{k \leq K} \left[ \text{Rank}_{\pi}(E^{(k)}) \right] - 1}{n_t - 1}$$

其中：
- $K$ = 粒子数 (Monte Carlo 维度, 如 1000)
- $n_t = |\mathcal{C}_t|$ = 当周在场选手数
- 期望 $\mathbb{E}_{k \leq K}$ 是对粒子的加权平均
- 分母 $n_t - 1$ 是对排名的归一化（选手数减一）

- **取值范围**: $[0, 1]$
- **解释**:
  - $\text{Alignment} = 0$：规则淘汰了人气第 1 名 (极度背离粉丝意愿)
  - $\text{Alignment} = 1$：规则淘汰了人气最后一名 (完全顺应粉丝意愿)
  - **值越高 → 规则对粉丝越友好** (Pro-Fan)

**定义：评审一致性得分 (Judge Alignment Score)**

$$\text{Alignment}_{Judge}(R) = \frac{\mathbb{E}_{k \leq K} \left[ \text{Rank}_{J}(E^{(k)}) \right] - 1}{n_t - 1}$$

- **解释**:
  - **值越高 → 规则对技术分越友好** (Pro-Judge/Meritocracy)

> **Note**: A higher Alignment score implies the rule eliminates contestants with lower standings in that dimension, thus preserving high-performers.

---

## 4. 微观分析：特定选手的生存压力测试

对于 Jerry Rice, Bobby Bones 等**在现实中存活**的争议选手，我们拥有他们存活期间的**真实未来数据**。我们可以进行**"死因测试"**。

对于选手 $Star$，在其参赛的每一个周次 $t$，计算其在新规则下的**被淘汰概率 (Probability of Elimination, PoE)**：

$$P(E = Star | R_{new}) = \sum_{k=1}^K w_t^{(k)} \cdot \mathbb{I}\left( Star \text{ is eliminated in simulation under } R_{new} \right)$$

### 4.1 Jerry Rice (S2, Rank → Percentage)

- **操作**：在 Jerry Rice 评审分最低的 Week 5，应用 $R_{pct}$。
    
- **逻辑**：由于 $R_{pct}$ 是分数直接相加，评审分的巨大劣势（例如 15 vs 25）需要巨大的粉丝份额 $\pi$ 才能弥补。
    
- **假设 (Hypothesis)**：如果 $P(E_{Week5} = Jerry | R_{pct}) > 90\%$，则结论为：**"如果 S2 使用百分比规则，Jerry Rice 有极大概率在第 5 周即被淘汰，无法获得亚军。"**

### 4.2 Bobby Bones (S27, Percentage → Judge Save)

- **操作**：在 S27 的每一周应用 $R_{save}$（含 $\beta_{judge}$ 的概率模型）。
    
- **逻辑**：
    
    1. 检测他是否掉入 Bottom 2：$P(Star \in \mathcal{B}_t) = \sum w^{(k)} \cdot \mathbb{I}(Star \in \text{Bottom2}^{(k)})$.
        
    2. 检测他是否被评审处死：在 Bottom 2 中，由于 Bobby 技术分极低，$\sigma(\beta(J_{opp} - J_{Bobby}))$ 趋近于 1。
        
- **假设 (Hypothesis)**：我们预测 Judge Save 机制可能成为 Bobby Bones 现象的"熔断器"——当人气选手的技术缺陷突破底线（掉入 Bottom 2）时，评审将以极高概率将其淘汰。

**待验证**：需在 Results 部分用实际模拟数据支撑此假设。

---

## 5. 规则组合的 2×2 矩阵分析

为了全面比较所有可能的规则组合，我们构建以下分析框架：

|  | **无 Judge Save (Direct Elimination)** | **有 Judge Save (Two-Stage)** |
|---|---|---|
| **Rank Rule** | 传统模式 (S1-S2) | **推荐模式** (S28+) |
| **Percentage Rule** | 严厉模式 (S3-S27) | 混合模式 (未实际采用) |

**每个象限的量化指标**：
- $\text{Alignment}_{Fan}$：民主度（对粉丝意愿的顺应程度）
- $\text{Alignment}_{Judge}$：技术度（对技术功底的奖励程度）
- $P(\text{Flip})$：历史翻盘率

### 6.3 预期发现

1. **Rank Rule** 提供更高的 $\text{Alignment}_{Fan}$ → 更民主
2. **Percentage Rule** 提供更高的 $\text{Alignment}_{Judge}$ → 更技术
3. **冗余假设 (The Redundancy Hypothesis)**:
   - 我们预测 "Percentage + Save" 的结果将与 "Percentage Only" 高度趋同（Agreement Rate > 95%）。
   - **原因**: Percentage Rule 已经极大地惩罚了低分选手（Alignment_Judge 很高），使得他们很难逃脱 Bottom 2。在此基础上叠加 Save，评委面对极低分的选手也不会行使拯救权。Save 机制因此变得冗余。

## 6. 综合建议的逻辑推导

基于上述定量分析，我们的推荐逻辑将建立在**"三难困境的平衡"**之上：

1. **公平性 (Meritocracy)**: 由 $\text{Alignment}_{Judge}$ 度量。——技术功底应获得奖励。

2. **粉丝参与度 (Engagement/Democracy)**: 由 $\text{Alignment}_{Fan}$ 度量。——观众投票应有意义。

3. **防爆冷机制 (Safety Valve)**: 由 Judge Save 的模拟效果度量。——极端情况下的纠偏能力。

### 推荐方案：Rank Rule + Judge Save

**论证逻辑**：

1. **Rank Rule 提供最高的"民主度"**：
   - 数据显示 Rank Rule 的 $\text{Alignment}_{Fan}$ 更高
   - 它允许人气选手在一定范围内生存，保护了节目的商业价值和粉丝热情
   - 相比之下，Percentage Rule 对"偏科选手"（高人气低技术）过于严厉

2. **Judge Save 提供底线的"技术度"**：
   - 反事实模拟将证明：当人气选手的技术缺陷突破底线（掉入 Bottom 2）时，Judge Save 能以高概率进行纠偏
   - 这防止了过于离谱的"民粹结果"
   
3. **Percentage + Save 的问题**：
   - Percentage Rule 在前期就会大量淘汰人气王，Save 无法挽回前面的损失
   - "亡羊补牢"不如"源头治理"

**结论**: Rank + Save 是 **"Balanced Optimization"（平衡最优解）**：
- **平时**：给予粉丝充分的话语权，保持节目热度
- **极端情况**：赋予专家一票否决权，维护比赛的技术底线

---

## 7. 总结

本思路构建了一个**深度融合 Q1 粒子滤波结果的概率分析框架**。

- **严谨性**：通过"逐周静态切片"避开了虚构数据的雷区。
- **可信度**：通过"概率化表述"（95% CI）量化了规则改变的风险，而非武断地宣称结果必变。
- **一致性**：Judge Save 的处理与 Q1 的行为模型完全通过 $\beta_{judge}$ 参数耦合，体现了极高的系统完整性。
- **完备性**：通过 2×2 矩阵分析覆盖了所有可能的规则组合，使推荐结论更具说服力。